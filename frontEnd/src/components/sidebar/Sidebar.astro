---
import type { string } from "astro/zod";
import Elemento from "./Elemento.astro";

interface Props {
  img?: string,
  nombre?: string,
  profesion?: string;
}

const { img, nombre, profesion } = Astro.props;
---

<div class="sidebar h-screen w-[100px] bg-white flex flex-col items-center flex-shrink-0 sticky top-0 transition-width duration-300 ease-in-out" id="sidebar">
    <div class="bg-darkBlue h-[100px] w-full flex items-center mb-6 relative justify-center">
      <div class="w-[60px] h-[60px] rounded-full bg-white">
        <img src="../../../public/img/perfil.png" alt="Easter egg" class="w-full h-full object-cover rounded-full">
      </div>
      <div class="ml-2 name-and-profession text-white">
        <p class="font-cocogooseLight text-paragraph2">{nombre}</p>
        <p class="font-cocogooseLight text-paragraph3">{profesion}</p>
      </div>
      <div class="w-[24px] h-[24px] rounded-full bg-white text-sm flex justify-center items-center absolute right-[-12px] cursor-pointer" id="toggleButton">
        <i class="fa-solid fa-angle-right"></i>
      </div>
    </div>
    <div class="flex flex-col items-center gap-y-4 w-full px-4" id="elementsContainer">
      <Elemento icon="fa-solid fa-user" texto="Perfil" />
      <Elemento icon="fa-solid fa-users" texto="Estudiantes" />
      <Elemento icon="fa-solid fa-trophy" texto="Logros" />
      <Elemento icon="fa-solid fa-lock" texto="Cambiar contraseña" />
      <Elemento icon="fa-solid fa-user-plus" texto="Crear estudiante" />
      <div class="w-full border-darkBlue border-[1px]"></div>
      <Elemento icon="fa-solid fa-arrow-right-from-bracket" texto="Salir" />
    </div>
  </div>
  
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const sidebar = document.getElementById('sidebar');
      const toggleButton = document.getElementById('toggleButton');
      let isExpanded = false;
  
      toggleButton.addEventListener('click', (e) => {
        e.stopPropagation(); // Evitar que el evento se propague al window
        isExpanded = !isExpanded;
        if (isExpanded) {
          sidebar.classList.add('w-[300px]');
          sidebar.classList.remove('w-[100px]');
          toggleButton.querySelector('i').classList.remove('fa-angle-right');
          toggleButton.querySelector('i').classList.add('fa-angle-left');
        } else {
          sidebar.classList.add('w-[100px]');
          sidebar.classList.remove('w-[300px]');
          toggleButton.querySelector('i').classList.remove('fa-angle-left');
          toggleButton.querySelector('i').classList.add('fa-angle-right');
        }
        updateVisibility(); // Llama a la función para actualizar la visibilidad del nombre y profesión
        document.querySelectorAll('.element-text').forEach(el => {
          el.classList.toggle('hidden', !isExpanded);
        });
      });
  
      window.addEventListener('click', (e) => {
        if (!sidebar.contains(e.target) && isExpanded) {
          isExpanded = false;
          sidebar.classList.add('w-[100px]');
          sidebar.classList.remove('w-[300px]');
          toggleButton.querySelector('i').classList.remove('fa-angle-left');
          toggleButton.querySelector('i').classList.add('fa-angle-right');
          updateVisibility(); // Llama a la función para actualizar la visibilidad del nombre y profesión
          document.querySelectorAll('.element-text').forEach(el => {
            el.classList.add('hidden');
          });
        }
      });
  
      function updateVisibility() {
        const nameAndProfession = document.querySelector('.name-and-profession');
        if (isExpanded) {
          nameAndProfession.classList.remove('hidden');
        } else {
          nameAndProfession.classList.add('hidden');
        }
      }
    });
  </script>